following code has been tested only on Linux

